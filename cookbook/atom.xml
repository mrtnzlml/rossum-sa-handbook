<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://mrtnzlml.github.io/rossum-sa-handbook/cookbook</id>
    <title>The Solution Architect's Handbook Blog</title>
    <updated>2025-08-14T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://mrtnzlml.github.io/rossum-sa-handbook/cookbook"/>
    <subtitle>The Solution Architect's Handbook Blog</subtitle>
    <icon>https://mrtnzlml.github.io/rossum-sa-handbook/img/128-blue-crunch.png</icon>
    <entry>
        <title type="html"><![CDATA[Multiple data matching results]]></title>
        <id>https://mrtnzlml.github.io/rossum-sa-handbook/cookbook/multiple-data-matching-results</id>
        <link href="https://mrtnzlml.github.io/rossum-sa-handbook/cookbook/multiple-data-matching-results"/>
        <updated>2025-08-14T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Data matching (Master Data Hub; MDH) results are by default returned into an "enum" field in Rossum (also known as "Options" field). Enum field allows to select only one of the values returned (it behaves as a regular HTML select element with options). What if you need to select multiple values, however?]]></summary>
        <content type="html"><![CDATA[<p>Data matching (Master Data Hub; MDH) results are by default returned into an "enum" field in Rossum (also known as "Options" field). Enum field allows to select only one of the values returned (it behaves as a regular <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/select" target="_blank" rel="noopener noreferrer">HTML select element</a> with options). What if you need to select multiple values, however?</p>
<p>The solution is to return all values into a <strong>hidden</strong> enum field and later process the data using a simple serverless function. In our example, the hidden field is <code>order_id_match</code>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> txscript </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> TxScript</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> default_to</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> substitute</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">rossum_hook_request_handler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> TxScript</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">from_payload</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">payload</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Do not recalculate if the input data has not changed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># (add more fields depending on the input into your MDH query):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    recalculate_hash </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f"</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">x</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">field</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">order_id</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">__</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">x</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">field</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">grn_id</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">field</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">recalculate_hash </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> recalculate_hash</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">hook_response</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Get all valid enum options (result of the MDH query):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    order_line_options </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> default_to</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">field</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">order_id_match</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">attr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">options</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    valid_options </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        opt </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> opt </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> order_line_options </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> opt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Clear existing multivalue table:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">field</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">order_id_lines </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Create new multivalue table:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    new_lines </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> option </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> valid_options</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        new_lines</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">"order__id"</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> option</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># What about other columns? Keep reading. :)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Insert new values into the multivalue table:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">field</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">order_id_lines </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> new_lines</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">field</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">recalculate_hash </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> recalculate_hash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">hook_response</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>The function does the following:</p>
<ol>
<li>Get all valid options from the <code>order_id_match</code> enum field.</li>
<li>Clear the existing <code>order_id_lines</code> table (our destination).</li>
<li>Insert the enum values into the <code>order_id_lines</code> destination table.</li>
</ol>
<p>Additionally, it takes care of recalculating the table lazily so users can update the final table manually if needed (see the <code>recalculate_hash</code> field).</p>
<p>This way, all data matching results were populated into multivalue table despite the data matching supporting only enum fields.</p>
<p>Note that it might be a good idea to lazily load additional values in the table. In real-world solution, the chain of hooks would look like this:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">.---------.      .--------------------------.      .---------.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  MDH 1  | ---&gt; |  Custom hook from above  | ---&gt; |  MDH 2  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">`---------`      `--------------------------`      `---------`</span><br></span></code></pre></div></div>
<p>This way, we can distribute only row IDs from the first MDH extension and load the actual data in the second MDH extension. Alternatively, we could populate all the data in the first MDH hook. That is however a bit laborious when there are many columns to populate and distribute.</p>
<div class="container_dm9A"><h3 class="header_J8KY">Test Your Knowledge</h3><p class="question_Y9ba">Can master data hub extension return values to a string field?</p><div class="buttonContainer_mbUi"><button class="button_lYqq">Yes, MDH can return values into any preconfigured field</button><button class="button_lYqq">No, only enum fields are supported</button></div></div>]]></content>
        <author>
            <name>Martin Zlámal</name>
            <uri>https://github.com/mrtnzlml</uri>
        </author>
        <author>
            <name>Václav Růt</name>
            <uri>https://github.com/VaclavRut</uri>
        </author>
        <category label="master-data-hub" term="master-data-hub"/>
        <category label="rossum-formulas" term="rossum-formulas"/>
    </entry>
</feed>